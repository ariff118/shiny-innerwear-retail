".*nintendo.*" = "Others",
".*lucky.*" = "Others",
"nordstrom lingerie" = "Nordstrom",
".*wacoal.*" = "Wacoal",
"us topshop" = "Topshop",
".*secret.*" = "Victoria Secret",
".*vanity.*" = "Others",
"s" = "Others",
".*hair.*" = "Others",
".*fila.*" = "Others"))
df$brand_name <- as.factor(df$brand_name)
df$brand_name <- df$brand_name %>% recode("Other brandOthers" = "Others",
"NordOtherstrom" = "Nordstrom",
"OtherOthers" = "Others",
"TopOthershop" = "Topshop")
df$brand_name <- paste(df$retailer, df$brand_name, sep = "-")
df <- df %>%
mutate(brand = as.factor(df$brand_name))
df$brand <- df$brand %>% recode("Nordstrom-Nordstrom" = "Nordstrom",
"Victoria Secret-Victoria Secret" = "Victoria Secret",
"Calvin Klein-Calvin Klein" = "Calvin Klein",
"Wacoal-Wacoal" = "Wacoal",
"Hanky Panky-Hanky Panky" = "Hanky Panky",
"Topshop-Topshop" = "Topshop")
## category
df$product_category <- as.factor(df$product_category)
category <- data.frame(levels(df$product_category))
df$product_category <- df$product_category %>%
str_to_lower()
df$category <- df$product_category %>%
str_replace_all(., c(".*bra.*" = "bra",
".*sock.*" = "accessories",
".*thong.*" = "panties",
".*bikini.*" = "swimwear",
".*sunnie wireless.*" = "bra",
".*bralette.*" = "bralette",
".*bandeau.*" = "bra",
".*brief.*" = "panties",
".*hat.*" = "accessories",
".*cheeky.*" = "panties",
".*hiphugger.*" = "panties",
".*shortie.*" = "panties",
".*boyshort.*" = "panties",
".*bridal.*" = "bridal",
".*sport bra.*" = "sport",
".*bridget.*" = "bra",
".*audrey.*" = "bra",
".*accessories.*" = "accessories",
".*brooke.*" = "brooke",
".*bottle.*" = "accessories",
".*cheekies.*" = "panties",
".*cami.*" = "sleep wear",
"cage front high-neck crop" = "swimwear",
".*panty.*" = "panties",
"coconut waters travel kit" = "accessories",
".*lingerie.*" = "lingerie",
".*push.*" = "bra",
".*tote.*" = "accessories",
".*hipster.*" = "panties",
".*babydoll.*" = "sleep wear",
"wrap triangle top" = "swimwear",
".*tomgirl.*" = "panties",
"ultimate high waist legging" = "sport",
"ultimate pocket legging" = "sport",
"ultimate yoga legging" = "sport",
".*undies.*" = "panties",
".*tank.*" = "sleep wear",
".*demi.*" = "bra",
".*bustier.*" = "bra",
".*brooke.*" = "bra",
".*lace.*" = "lingerie",
"cross-back scoop" = "swimwear",
".*teddy.*" = "lingerie",
".*sleep.*" = "sleep wear",
"embroidered mesh bodysuit" = "lingerie",
".*cheekster.*" = "panties",
".*kimono.*" = "sleep wear",
".*gym.*" = "sport",
".*belt.*" = "accessories",
".*one-piece.*" = "swimwear",
".*onepiece.*" = "swimwear",
".*halter.*" = "swimwear",
"high-neck wrap" = "swimwear",
"knotted back body wrap top" = "swimwear",
".*panties.*" = "panties",
".*triangle.*" = "panties",
".*slip.*" = "sleep wear",
"sunnie full coverage" = "bra",
".*one piece.*" = "swimwear",
".*sport.*" = "sport",
"logo elastic short" = "sleepwear",
".*tee.*" = "sleepwear",
"lightly lined macram√© high-neck" = "swimwear",
".*racerback.*" = "bra",
".*petal.*" = "accessories",
"deep v crop" = "bra",
".*hannah.*" = "bra",
".*full-zip.*" = "sport",
".*hineck.*" = "bra",
".*katie.*" = "bra",
".*longline.*" = "bra",
".*lorna jane.*" = "bra",
"mesh-cap-sleeve bodysuit" = "lingerie",
".*move.*" = "sport",
"new! day to play" = "bra",
"padded" = "bra",
"play" = "bra",
"plunge" = "bra",
"split hem tunic" = "sport",
"summer" = "bra",
"sleep wear" = "sleepwear",
"classic" = "bra",
"bride" = "bridal"))
## treat "chill" and "collections" categories
df <- df %>%
mutate(last_word_chill = ifelse(category == "chill", word(df$product_name,-3, -1), "NA"),
last_word_collections = ifelse(category == "collections", word(df$product_name,-3, -1), "NA"))
### "chill" category
df$last_word_chill <- as.factor(df$last_word_chill)
big_categories <- data.frame(levels(df$last_word_chill))
View(big_categories)
bra <- str_which(df$last_word_chill, pattern = ".*Bra.*|.*Bralette.*|.*Bandeau.*|.*Crop.*")
df$category[bra] <- "bra"
### "collections" category
df$last_word_collections <- as.factor(df$last_word_collections)
big_categories_2 <- data.frame(levels(df$last_word_collections))
View(big_categories_2)
panties2 <- str_which(df$last_word_collections, pattern = ".*G-.*|.*V-.*|.*Panty.*|.*Hipster.*|.*Thong.*|.*Boyshort.*|.*Teddy.*|.*Tanga.*|.*Brief.*|.*Panties.*|.*Tap Pant.*|.*thong.*")
bra2 <- str_which(df$last_word_collections, pattern = ".*Bra.*|.*Bralette.*|.*Bandeau.*|.*Crop.*")
bride2 <- str_which(df$last_word_collections, pattern = ".*Bride.*")
sleepwear2 <- str_which(df$last_word_collections, pattern = ".*Chemise.*|.*Cami.*|.*Top.*|.*T-Shirt.*|.*Slip.*|.*Sleep.*|.*Tank.*|.*Robe.*|.*Gown.*|.*Pajamas.*|.*Short.*|.*Pant.*")
accessories2 <- str_which(df$last_word_collections, pattern = ".*Sock.*|.*Garter.*|.*Cuff.*|.*Plaything.*|.*Leg.*|Set with Gift Box")
swimwear2 <- str_which(df$last_word_collections, pattern = ".*Bikini.*")
lingerie2 <- str_which(df$last_word_collections, pattern = ".*Bodysuit.*|.*Slit.*")
df$category[panties2] <- "panties"
df$category[bra2] <- "bra"
df$category[bride2] <- "bridal"
df$category[sleepwear2] <- "sleepwear"
df$category[accessories2] <- "accessories"
df$category[swimwear2] <- "swimwear"
df$category[lingerie2] <- "lingerie"
### check final category list after cleaning
df$category <- as.factor(df$category)
grouped_category <- data.frame(levels(df$category))
## drop unused factors from category
df$category <- fct_drop(df$category, only = "collections")
df$category <- fct_drop(df$category, only = "chill")
levels(df$category)
df <- df %>%
mutate(extra_last_word_collections = ifelse(category == "collections", word(df$product_name,-1), "NA"))
df$extra_last_word_collections <- as.factor(df$extra_last_word_collections)
big_categories_3 <- data.frame(levels(df$extra_last_word_collections))
View(big_categories_3)
View(big_categories_3)
panties3 <- str_which(df$last_word_collections, pattern = ".*G-.*|.*V-.*|.*Panty.*|.*Hipster.*|.*Thong.*|.*Boyshort.*|.*Teddy.*|.*Tanga.*|.*Brief.*|.*Panties.*|.*Tap Pant.*|.*thong.*|.*Trim.*|.*Cover.*")
bra3 <- str_which(df$last_word_collections, pattern = ".*Bra.*|.*Bralette.*|.*Bandeau.*|.*Crop.*")
sleepwear3 <- str_which(df$last_word_collections, pattern = ".*Chemise.*|.*Cami.*|.*Top.*|.*shirt.*|.*Slip.*|.*Sleep.*|.*Tank.*|.*Robe.*|.*Gown.*|.*Pajamas.*|.*Short.*|.*Pant.*|.*Romper.*")
accessories3 <- str_which(df$last_word_collections, pattern = ".*Sock.*|.*Garter.*|.*Cuff.*|.*Plaything.*|.*Leg.*|.*Box.*|.*Key.*|.*Jar.*|.*Eye.*|.*Bag.*")
swimwear3 <- str_which(df$last_word_collections, pattern = ".*Bikini.*")
lingerie3 <- str_which(df$last_word_collections, pattern = ".*Bodysuit.*|.*Slit.*|.*Plaything.*")
panties3 <- str_which(df$extra_last_word_collections, pattern = ".*G-.*|.*V-.*|.*Panty.*|.*Hipster.*|.*Thong.*|.*Boyshort.*|.*Teddy.*|.*Tanga.*|.*Brief.*|.*Panties.*|.*Tap Pant.*|.*thong.*|.*Trim.*|.*Cover.*")
bra3 <- str_which(df$extra_last_word_collections, pattern = ".*Bra.*|.*Bralette.*|.*Bandeau.*|.*Crop.*")
sleepwear3 <- str_which(df$extra_last_word_collections, pattern = ".*Chemise.*|.*Cami.*|.*Top.*|.*shirt.*|.*Slip.*|.*Sleep.*|.*Tank.*|.*Robe.*|.*Gown.*|.*Pajamas.*|.*Short.*|.*Pant.*|.*Romper.*")
accessories3 <- str_which(df$extra_last_word_collections, pattern = ".*Sock.*|.*Garter.*|.*Cuff.*|.*Plaything.*|.*Leg.*|.*Box.*|.*Key.*|.*Jar.*|.*Eye.*|.*Bag.*")
swimwear3 <- str_which(df$extra_last_word_collections, pattern = ".*Bikini.*")
lingerie3 <- str_which(df$extra_last_word_collections, pattern = ".*Bodysuit.*|.*Slit.*|.*Plaything.*")
panties3
df$category[panties3] <- "panties"
df$category[bra3] <- "bra"
df$category[sleepwear3] <- "sleepwear"
df$category[accessories3] <- "accessories"
df$category[swimwear3] <- "swimwear"
df$category[lingerie3] <- "lingerie"
df$category <- as.factor(df$category)
grouped_category <- data.frame(levels(df$category))
View(grouped_category)
panties3 <- str_which(df$extra_last_word_collections, pattern = ".*G-.*|.*V-.*|.*Panty.*|.*Hipster.*|.*Thong.*|.*Boyshort.*|.*Teddy.*|.*Tanga.*|.*Brief.*|.*Panties.*|.*Tap Pant.*|.*thong.*|.*Trim.*|.*Cover.*|.*Pack.*")
df$category[panties3] <- "panties"
## drop unused factors from category
df$category <- fct_drop(df$category, only = "collections")
df$category <- fct_drop(df$category, only = "chill")
levels(df$category)
summary(df)
## color
df$color <- df$color %>%
str_to_lower()
df$color <- as.factor(df$color)
color_list <- data.frame(levels(df$color))
View(color_list)
View(df)
df$color_group <- df$color %>%
str_replace_all(., c(".*white.*" = "white",
".*turquoise.*" = "turquoise",
".*pink.*" = "pink",
".*teal.*" = "teal",
".*navy.*" = "navy",
".*berry.*" = "berry",
".*green.*" = "green",
".*red.*" = "red",
".*blue.*" = "blue",
".*cobalt.*" = "blue",
".*buff.*" = "nude",
".*charcoal.*" = "grey",
".*grey.*" = "grey",
".*gray.*" = "grey",
".*coral.*" = "coral",
".*crystal.*" = "no color",
".*burgundy.*" = "purple",
".*plum.*" = "purple",
".*slate.*" = "multiple colors",
"be pretty" = "multiple colors",
".*mint.*" = "green",
"fresh bright" = "multiple colors",
"heather frost" = "multiple colors",
".*hush.*" = "nude",
".*jade.*" = "green",
".*kissed.*" = "multiple colors",
"light aglow" = "multiple colors",
"darkness falls" = "black",
".*multi.*" = "multiple colors",
".*ocean.*" = "blue",
".*nude.*" = "nude",
".*oatmeal.*" = "nude",
".*olive.*" = "olive",
".*purple.*" = "purple",
".*rose.*" = "red",
".*sienna.*" = "nude",
".*peel.*" = "nude",
"rio" = "multiple colors",
".*muslin.*" = "nude",
".*peach.*" = "nude",
"stargaze" = "multiple colors",
"stone" = "multiple colors",
"tangerine crush" = "coral",
".*black.*" = "black",
".*berry.*" = "purple",
"dark heather" = "multiple colors",
"light cashew" = "nude",
"light heather" = "multiple colors",
"luminous fuchsia" = "purple",
"maroon lagoon" = "multiple colors",
"medium heather" = "multiple colors",
"radiance" = "multiple colors",
"silver shadow" = "multiple colors",
"ur cheeky" = "multiple colors",
"valentine" = "red",
"2vn" = "multiple colors",
".*print.*" = "multiple colors",
".*beige.*" = "nude",
".*allure.*" = "nultiple colors",
"almond blossom" = "multiple colors"))
color_list <- data.frame(unique(df$color_group))
df$color_group <- df$color %>%
str_replace_all(., c(".*white.*" = "white",
".*turquoise.*" = "turquoise",
".*pink.*" = "pink",
".*teal.*" = "teal",
".*navy.*" = "navy",
".*berry.*" = "berry",
".*green.*" = "green",
".*red.*" = "red",
".*blue.*" = "blue",
".*cobalt.*" = "blue",
".*buff.*" = "nude",
".*charcoal.*" = "grey",
".*grey.*" = "grey",
".*gray.*" = "grey",
".*coral.*" = "coral",
".*crystal.*" = "no color",
".*burgundy.*" = "purple",
".*plum.*" = "purple",
".*slate.*" = "multiple colors",
"be pretty" = "multiple colors",
".*mint.*" = "green",
"fresh bright" = "multiple colors",
"heather frost" = "multiple colors",
".*hush.*" = "nude",
".*jade.*" = "green",
".*kissed.*" = "multiple colors",
"light aglow" = "multiple colors",
"darkness falls" = "black",
".*multi.*" = "multiple colors",
".*ocean.*" = "blue",
".*nude.*" = "nude",
".*oatmeal.*" = "nude",
".*olive.*" = "olive",
".*purple.*" = "purple",
".*rose.*" = "red",
".*sienna.*" = "nude",
".*peel.*" = "nude",
"rio" = "multiple colors",
".*muslin.*" = "nude",
".*peach.*" = "nude",
"stargaze" = "multiple colors",
"stone" = "multiple colors",
"tangerine crush" = "coral",
".*black.*" = "black",
".*berry.*" = "purple",
"dark heather" = "multiple colors",
"light cashew" = "nude",
"light heather" = "multiple colors",
"luminous fuchsia" = "purple",
"maroon lagoon" = "multiple colors",
"medium heather" = "multiple colors",
"radiance" = "multiple colors",
"silver shadow" = "multiple colors",
"ur cheeky" = "multiple colors",
"valentine" = "red",
"2vn" = "multiple colors",
".*print.*" = "multiple colors",
".*beige.*" = "nude",
".*allure.*" = "nultiple colors",
"almond blossom" = "multiple colors",
".*large.*" = "multiple colors",
".*lake.*" = "blue",
".*ivory.*" = "nude",
".*vanilla.*" = "nude",
".*chestnut.*" = "brown",
"platinum combo" = "multiple colors",
".*peacoat.*" = "multiple colors",
".*night.*" = "multiple colors",
".*gardenia.*" = "nude",
".*small.*" = "multiple colors",
".*sand.*" = "nude",
".*toast.*" = "nude",
".*speak.*" = "multiple colors",
".*blithe.*" = "multiple colors",
".*cappuccino.*" = "brown",
".*taupe.*" = "purple",
".*midnight.*" = "blue",
".*logo.*" = "multiple colors",
".*multiple.*" = "multiple colors"))
color_list <- data.frame(unique(df$color_group))
df$color_group <- df$color %>%
str_replace_all(., c(".*white.*" = "white",
".*turquoise.*" = "turquoise",
".*pink.*" = "pink",
".*teal.*" = "teal",
".*navy.*" = "navy",
".*berry.*" = "berry",
".*green.*" = "green",
".*red.*" = "red",
".*blue.*" = "blue",
".*cobalt.*" = "blue",
".*buff.*" = "nude",
".*charcoal.*" = "grey",
".*grey.*" = "grey",
".*gray.*" = "grey",
".*coral.*" = "coral",
".*crystal.*" = "no color",
".*burgundy.*" = "purple",
".*plum.*" = "purple",
".*slate.*" = "multiple colors",
"be pretty" = "multiple colors",
".*mint.*" = "green",
"fresh bright" = "multiple colors",
".*heather.*" = "multiple colors",
".*hush.*" = "nude",
".*jade.*" = "green",
".*kissed.*" = "multiple colors",
"light aglow" = "multiple colors",
"darkness falls" = "black",
".*multi.*" = "multiple colors",
".*ocean.*" = "blue",
".*nude.*" = "nude",
".*oatmeal.*" = "nude",
".*olive.*" = "olive",
".*purple.*" = "purple",
".*rose.*" = "red",
".*sienna.*" = "nude",
".*peel.*" = "nude",
"rio" = "multiple colors",
".*muslin.*" = "nude",
".*peach.*" = "nude",
"stargaze" = "multiple colors",
"stone" = "multiple colors",
"tangerine crush" = "coral",
".*black.*" = "black",
".*berry.*" = "purple",
"light cashew" = "nude",
".*fuchsia.*" = "purple",
".*lagoon.*" = "multiple colors",
"radiance" = "multiple colors",
"silver shadow" = "multiple colors",
"ur cheeky" = "multiple colors",
"valentine" = "red",
"2vn" = "multiple colors",
".*print.*" = "multiple colors",
".*beige.*" = "nude",
".*allure.*" = "nultiple colors",
"almond blossom" = "multiple colors",
".*large.*" = "multiple colors",
".*lake.*" = "blue",
".*ivory.*" = "nude",
".*vanilla.*" = "nude",
".*chestnut.*" = "brown",
"platinum combo" = "multiple colors",
".*peacoat.*" = "multiple colors",
".*night.*" = "multiple colors",
".*gardenia.*" = "nude",
".*small.*" = "multiple colors",
".*sand.*" = "nude",
".*toast.*" = "nude",
".*speak.*" = "multiple colors",
".*blithe.*" = "multiple colors",
".*cappuccino.*" = "brown",
".*taupe.*" = "purple",
".*midnight.*" = "blue",
".*logo.*" = "shape",
".*multiple.*" = "multiple colors",
".*wild.*" = "multiple colors",
".*violet.*" = "purple",
".*dot.*" = "multiple colors",
".*floral.*" = "shape",
".*brown.*" = "brown",
".*scandal.*" = "multiple colors",
".*skin.*" = "nude",
".*leopard.*" = "shape",
".*mocha.*" = "brown",
".*rainbow.*" = "multiple colors",
".*stripe.*" = "shape"))
color_list <- data.frame(unique(df$color_group))
View(color_list)
## transform data type
df$rating <- as.numeric(df$rating)
df$review_count <- as.integer(df$review_count)
## transform missing data in mrp, price, rating, view count
df$mrp[is.na(df$mrp)] <- round(mean(df$mrp, na.rm = TRUE), 2)
## transform missing data in mrp, price, rating, view count
df$rating[is.na(df$rating)] <- min(df$rating, na.rm = TRUE)
df$review_count[is.na(df$review_count)] <- min(df$review_count, na.rm = TRUE)
df <- df %>%
mutate(pct_sales = round(-1*(price_converted-mrp_converted)/mrp_converted), 2)
df <- df %>%
mutate(pct_sales = round((-1*(price_converted-mrp_converted)/mrp_converted),2))
# getting final dataframe
## drop NAs from "mrp" since one of the main goal is to look at price range
df <- df %>%
filter(!category%in% c("chill", "collections")) %>%
select(-last_word_chill, -last_word_collections, -extra_last_word_collections, -2)
## mutate new column - percentage of sales
df_final <- df %>%
select(product_name, mrp_converted, price_converted, pct_sales, category, color_group, brand, rating, review_count)
View(df_final)
# output clean data
write_csv(df_final, "../data/cleaned/cleaned_shiny.csv")
summary(df_final)
write_csv(raw_df, "../data/raw/raw_full_df.csv")
# read in data and set up important packages for this Shiny App
library(shiny)
library(tidyverse)
df <- read_csv("cleaned_shiny.csv")
setwd("~/Desktop/labs/shiny-innerwear-retail/src/app")
df <- read_csv("cleaned_shiny.csv")
setwd("~/Desktop/labs/shiny-innerwear-retail/src/app/shiny-innerwear")
df <- read_csv("cleaned_shiny.csv")
runApp()
max(df$price)
# output clean data
write_csv(df_final, "../data/cleaned/cleaned_shiny.csv")
df <- read_csv("cleaned_shiny.csv")
runApp()
max(df$price_converted)
max(df$rating)
min(df$rating)
runApp()
max(df$price_converted)
df %>% filter(price_converted = max(price_converted))
df %>% filter(price_converted == max(price_converted))
df %>% group_by(brand) %>% summarise(average_rating = mean(rating))
runApp()
runApp()
# read in data and set up important packages for this Shiny App
library(shiny)
library(tidyverse)
df <- read_csv("cleaned_shiny.csv")
setwd("~/Desktop/labs/shiny-innerwear-retail/src/app/shiny-innerwear")
df <- read_csv("cleaned_shiny.csv")
range(df$price_converted)
df %>%
rename(c("mrp_converted" = "mrp", "price_converted" = "price", "color_group" = "color"))
df %>%
rename(mrp_converted=mrp, price_converted = price, color_group = color))
df %>%
rename(mrp_converted=mrp, price_converted = price, color_group = color)
df %>%
rename(mrp_converted="mrp", price_converted = "price", color_group = "color")
df %>%
rename(mrp = mrp_converted, price = price_converted, color = color_group)
df <- df %>%
rename(mrp = mrp_converted, price = price_converted, color = color_group)
names(df$brand)
names(df)
df %>%
group_by(brand, category) %>%
summarise(tot_product = n())
runApp()
runApp()
shiny::runApp('app/shiny-innerwear')
print(environment(showElement))
print(environment(show))
runApp('app/shiny-innerwear')
shiny::runApp('app/shiny-innerwear')
devtools::session_info()
install.packages("shiny")
install.packages("shiny")
shiny::runApp('app/shiny-innerwear')
runApp('app/shiny-innerwear')
shiny::runApp('app/shiny-innerwear')
shiny::runApp('app/shiny-innerwear')
runApp('app/shiny-innerwear')
runApp('app/shiny-innerwear')
